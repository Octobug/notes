# 第九章 vim 程序编辑器

> <http://cn.linux.vbird.org/linux_basic/0310vi.php>

## 目录

- [第九章 vim 程序编辑器](#第九章-vim-程序编辑器)
  - [目录](#目录)
  - [9.1 vi 与 vim](#91-vi-与-vim)
    - [9.1.1 为何要学 vim](#911-为何要学-vim)
  - [9.2 vi 的使用](#92-vi-的使用)
    - [9.2.1 简易执行范例](#921-简易执行范例)
    - [9.2.2 按键说明](#922-按键说明)
    - [9.2.3 一个案例练习](#923-一个案例练习)
    - [9.2.4 vim 的暂存盘、救援回复与打开时的警告信息](#924-vim-的暂存盘救援回复与打开时的警告信息)
  - [9.3 vim 的额外功能](#93-vim-的额外功能)
    - [9.3.1 区块选择 (Visual Block)](#931-区块选择-visual-block)
    - [9.3.2 多文件编辑](#932-多文件编辑)
    - [9.3.3 多窗口功能](#933-多窗口功能)
    - [9.3.4 vim 的挑字补全功能](#934-vim-的挑字补全功能)
    - [9.3.5 vim 环境设置与记录: ~/.vimrc, ~/.viminfo](#935-vim-环境设置与记录-vimrc-viminfo)
    - [9.3.6 vim 常用指令示意图](#936-vim-常用指令示意图)
  - [9.4 其他 vim 使用注意事项](#94-其他-vim-使用注意事项)
    - [9.4.1 中文编码的问题](#941-中文编码的问题)
    - [9.4.2 DOS 与 Linux 的断行字符](#942-dos-与-linux-的断行字符)
    - [9.4.3 语系编码转换](#943-语系编码转换)
  - [9.5 重点回顾](#95-重点回顾)
  - [9.6 本章练习](#96-本章练习)
  - [9.7 参考资料与延伸阅读](#97-参考资料与延伸阅读)

## 9.1 vi 与 vim

几乎所有的 Unix-like OS 都有 vi 编辑器，而 vim 是 vi 的加强版: Vi IMproved - a
programmer's text editor.

### 9.1.1 为何要学 vim

- 所有 Unix-like 系统都有 vi 编辑器
- 很多软件的编辑模式都会调用 vi
- vim 可以作为程序编辑器
- 快！

## 9.2 vi 的使用

- command mode
- insert mode: 由 `i, I, o, O, a, A, r, R` 进入
- command-line mode: 由 `:, /, ?` 进入

### 9.2.1 简易执行范例

### 9.2.2 按键说明

### 9.2.3 一个案例练习

### 9.2.4 vim 的暂存盘、救援回复与打开时的警告信息

vim 会在被编辑的文件的目录下创建 `.filename.swp` 文件，用于记录操作

## 9.3 vim 的额外功能

### 9.3.1 区块选择 (Visual Block)

| 按键     | 意义           |
| -------- | -------------- |
| v        | 字符选择       |
| V        | 行选择         |
| [Ctrl]+v | 区块选择       |
| y        | 复制选择的部分 |
| d        | 删除选择的部分 |
| p        | 粘贴复制的区块 |

### 9.3.2 多文件编辑

| 按键   | 意义                        |
| ------ | --------------------------- |
| :n     | 编辑下一个文件              |
| :N     | 编辑上一个文件              |
| :files | 列出当前 vim 打开的所有文件 |

### 9.3.3 多窗口功能

| 按键             | 意义                                            |
| ---------------- | ----------------------------------------------- |
| `:sp [filename]` | 打开新窗口，如果输入 filename，则打开一个新文件 |
| `[ctrl]+w+j/↓`   | 切换光标到下方窗口                              |
| `[ctrl]+w+k/↑`   | 切换光标到上方窗口                              |
| `[ctrl]+w+q`     | 退出窗口                                        |

### 9.3.4 vim 的挑字补全功能

| 按键                 | 意义                                        |
| -------------------- | ------------------------------------------- |
| [ctrl]+x -> [ctrl]+n | 使用当前文件内容作为关键字补齐              |
| [ctrl]+x -> [ctrl]+f | 使用当前目录内的文件名为关键字补齐          |
| [ctrl]+x -> [ctrl]+o | 使用扩展名作为语法补齐，使用 vim 内置关键字 |

### 9.3.5 vim 环境设置与记录: ~/.vimrc, ~/.viminfo

| 环境设置参数                      | 意义                                     |
| --------------------------------- | ---------------------------------------- |
| :set nu, :set nonu                | 行号                                     |
| :set hlsearch, set nohlsearch     | 高亮搜索                                 |
| :set autoindent, set noautoindent | 自动缩进                                 |
| :set backup                       | 自动备份文件                             |
| :set ruler                        | 右下角的状态信息                         |
| :set showmode                     | 左下角的状态信息                         |
| :set backspace=(012)              | 0/1: 只能删除新内容，2: 可以删除任意内容 |
| :set all                          | 显示所有环境参数                         |
| :set                              | 显示与系统默认值不同的参数               |
| :syntax on, syntax off            | 是否显示语法                             |
| :set bg=dark, set bg=light        | 编辑器背景颜色                           |

### 9.3.6 vim 常用指令示意图

## 9.4 其他 vim 使用注意事项

### 9.4.1 中文编码的问题

1. 与 `/etc/locale.conf` 有关
2. 与终端接口语系有关: `LANG`, `LC_ALL` 环境变量
3. 文件本身的编码
4. 打开终端机的软件

### 9.4.2 DOS 与 Linux 的断行字符

- Windows: CR+LF
- Linux: LF
- 使用 `dos2unix` 与 `unix2dos` 互相转换

### 9.4.3 语系编码转换

- `iconv -f fromcode -t tocode filename [-o newfile]`
- 从正体中文 utf8 转成简体中文 utf8 需要多次:
  
  ```sh
  iconv -f utf8 -t big5 vi.utf8 | \
    iconv -f big5 -t gb2312 | iconv -f gb2312 -t utf8 -o vi.gb.utf8
  ```

## 9.5 重点回顾

## 9.6 本章练习

## 9.7 参考资料与延伸阅读
